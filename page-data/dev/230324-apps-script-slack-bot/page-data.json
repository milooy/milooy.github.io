{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/dev/230324-apps-script-slack-bot/","result":{"data":{"site":{"siteMetadata":{"title":"ìœ ë¦¼ë¡œê·¸"}},"markdownRemark":{"id":"667a8f92-1251-5539-b6ce-df9b93b8604d","excerpt":"ê°œë°œ ë°©ë²• https://api.slack.com/apps ì—ì„œ Create an app ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤. image From scratchë¥¼ ëˆ„ë¥´ê³  ì›í•˜ëŠ” App name, workspaceë¥¼ ì ì–´ì¤ë‹ˆë‹¤. image image ì¢Œì¸¡ ë©”ë‰´ì—ì„œ Incoming webhookâ€¦","html":"<h2>ê°œë°œ ë°©ë²•</h2>\n<ol>\n<li><a href=\"https://api.slack.com/apps\">https://api.slack.com/apps</a> ì—ì„œ Create an app ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446510-06cec9d8-f3f1-471b-82dd-28262b690cfa.png\" alt=\"image\"></p>\n<ol start=\"2\">\n<li>From scratchë¥¼ ëˆ„ë¥´ê³  ì›í•˜ëŠ” App name, workspaceë¥¼ ì ì–´ì¤ë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446600-45ffc371-97af-4170-a3bd-6c216214a809.png\" alt=\"image\"></p>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446644-5a481dfd-94d7-4351-9177-f93ccb5d910e.png\" alt=\"image\"></p>\n<ol>\n<li>ì¢Œì¸¡ ë©”ë‰´ì—ì„œ Incoming webhookì„ ëˆ„ë¥´ê³ , Activateí•´ì¤ë‹ˆë‹¤. ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•œ ìŠ¬ë™ì´ë¼ë©´ ê´€ë¦¬ìì˜ ìŠ¹ì¸ì„ ë°›ì•„ì£¼ì„¸ìš”.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446718-7dc0f1e7-84f7-47bd-b62f-781a06424e66.png\" alt=\"image\"></p>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446836-c6c3f62c-2e56-4de3-917d-b193a311eeef.png\" alt=\"image\"></p>\n<ol start=\"4\">\n<li>Incoming Webhooks í˜ì´ì§€ì—ì„œ [Add new webhook to Workspace] ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227446921-458dc3d9-5d9c-4f53-8dec-fe586919bd41.png\" alt=\"image\"></p>\n<ol start=\"5\">\n<li>ë©”ì„¸ì§€ ì „ì†¡ì„ ì›í•˜ëŠ” ì±„ë„ì„ ì„ íƒí•©ë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447103-4bcb6a67-0eb0-41ac-904e-9d5c4730884a.png\" alt=\"image\"></p>\n<ol start=\"6\">\n<li>ì›¹í›… URLì´ ë‚˜ì™”ì–´ìš”. ì´ URLì„ ì´ë”° ì‚¬ìš©í• ê±°ì˜ˆìš”.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447206-40d52dc9-dcc4-49ec-b864-a0e81f2bb959.png\" alt=\"image\"></p>\n<ol start=\"7\">\n<li>í‘¸ì‹œë¥¼ ì›í•˜ëŠ” ë©”ì„¸ì§€ ë””ë¹„ë¥¼ êµ¬ê¸€ë‹¥ìŠ¤ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë©”ë‰´ì—ì„œ í™•ì¥ í”„ë¡œê·¸ë¨ > Apps Scriptsë¥¼ ëˆŒëŸ¬ì¤ë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447287-35caddf2-1a9a-4114-b6ee-50968f3f3501.png\" alt=\"image\"></p>\n<ol start=\"8\">\n<li>ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ì½ì–´ ì›í•˜ëŠ” ìŠ¬ë™ ì±„ë„ì— ë©”ì„¸ì§€ë¥¼ ë³´ë‚´ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. urlì—ëŠ” ì•„ê¹Œ ë§Œë“  ì›¹í›… URLì„ ì ì–´ì£¼ê³ , ì›í•˜ëŠ” ì±„ë„ëª…ë„ ë°”ê¿”ì„œ ì ì–´ì¤ë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447338-c03b7a74-d896-4f35-87f7-16439bbe986d.png\" alt=\"image\"></p>\n<p>ë©‹ì§„ ì½”ë“œë¥¼ ì‘ì„±í•´ì£¼ì‹  í† ìŠ¤ì¦ê¶Œì˜ ë‚˜ì†Œì¸ ë‹˜ ê°ì‚¬í•´ìš”!</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendtoslack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> today <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>today<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://hooks.slack.com/services/T03FE7QJV/ë‹¹ì‹ ì˜ì›¹í›…URL\"</span><span class=\"token punctuation\">;</span> \n\n  <span class=\"token keyword\">var</span> sheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> dataRange <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getDataRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> values <span class=\"token operator\">=</span> dataRange<span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">var</span> searchValue <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> updateValue <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> updateColumn <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// the column number to update</span>\n  \n  <span class=\"token keyword\">var</span> updateRow <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// initialize to -1 to indicate value not found</span>\n\n  <span class=\"token keyword\">var</span> totalCount <span class=\"token operator\">=</span> values<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> currentCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> values<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    currentCount<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> searchValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      updateRow <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// add 1 to convert from 0-indexed to 1-indexed</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>updateRow <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> rangeToUpdate <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>updateRow<span class=\"token punctuation\">,</span> updateColumn<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    rangeToUpdate<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>updateValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> values <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>updateRow<span class=\"token punctuation\">,</span> updateColumn<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> value <span class=\"token operator\">=</span> values<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> payload <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"channel\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#ì›í•˜ëŠ”ì±„ë„ëª…\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"blocks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"section\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"mrkdwn\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"> _ì ì‹¬ì„ ê½¤ë‚˜ ë‘”ë‘”í•˜ê²Œ ë“œì‹  ëª¨ì–‘ì´ë¡œêµ°._\\n> _í›„ì‹ìœ¼ë¡œ ê°„ë‹¨í•œ íƒ€ì…ì±Œë¦°ì§€ í•˜ë‚˜ í’€ê³ ê°€ì‹œê²Œ._\\n\"</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"divider\"</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"section\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"mrkdwn\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">:ts-boom: *[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">] </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">* (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>currentCount <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>totalCount <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">) &lt;</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">|ğŸ”—></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-property property\">\"accessory\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"button\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">\"style\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"primary\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"plain_text\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ë¬¸ì œí’€ëŸ¬ê°€ê¸°ğŸ§©\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"emoji\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string-property property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://tsch.js.org/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>value<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/play/ko</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"divider\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"post\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"contentType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"payload\"</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">return</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"9\">\n<li>[ì‹¤í–‰]ì„ ëˆ„ë¥´ë©´ í…ŒìŠ¤íŠ¸í•´ë³´ì‹¤ ìˆ˜ ìˆì–´ìš”.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447391-8b29d4da-84be-475d-9e56-47c4f4f97103.png\" alt=\"image\"></p>\n<ol start=\"10\">\n<li>ì‹œê³„ ëª¨ì–‘ ì•„ì´ì½˜ì„ ëˆŒëŸ¬ íŠ¸ë¦¬ê±° í˜ì´ì§€ì— ë“¤ì–´ê°€ê³ , [íŠ¸ë¦¬ê±° ì¶”ê°€]ë²„íŠ¼ì„ ëˆŒëŸ¬ ì›í•˜ëŠ” íŠ¸ë¦¬ê±° ê¸°ì¤€ì„ ì„¤ì •í•´ì¤ë‹ˆë‹¤.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447469-6a9f5205-82dd-4729-acfd-b567c1b5b10d.png\" alt=\"image\"></p>\n<ol start=\"11\">\n<li>ì™„ë£Œ! ê³ ìƒí•˜ì…¨ì–´ìš”.</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/3839771/227447522-cdf58e8f-1973-488e-ac08-79c498313d9b.png\" alt=\"image\"></p>\n<h1>ì°¸ê³ </h1>\n<ul>\n<li><a href=\"https://www.august.com.au/blog/how-to-send-slack-alerts-from-google-sheets-apps-script/\">https://www.august.com.au/blog/how-to-send-slack-alerts-from-google-sheets-apps-script/</a></li>\n</ul>","frontmatter":{"title":"Google Apps Scriptë¥¼ í™œìš©í•œ ìŠ¬ë™ë´‡ ë§Œë“¤ê¸°","date":"March 24, 2023","description":"íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì±Œë¦°ì§€ë¥¼ ìŠ¬ë™ì— ì´ë³´ì","category":"dev"}},"previous":{"fields":{"slug":"/dev/230301-mil/"},"frontmatter":{"title":"2023ë…„ 3ì›” Monthly I Learned"}},"next":{"fields":{"slug":"/dev/230328-type-challange/"},"frontmatter":{"title":"íƒ€ì…ì±Œë¦°ì§€ í’€ê¸°"}}},"pageContext":{"id":"667a8f92-1251-5539-b6ce-df9b93b8604d","previousPostId":"076a4a81-7087-595d-87d9-956c1104cce5","nextPostId":"88a0d3e0-d921-5f63-ac3b-efa60f868cae"}},"staticQueryHashes":["2841359383","3257411868"]}